# 単一財市場の理論

## 分業と財の交換

経済学における市場とは人々がお金などを介して財の交換を行う場である。個々人がひとりで生産できる財の種類はどんなに器用な人だとしてもほんの僅かである。
すぐれた畜産農家が卓越した金物職人であることはまずありえないであろうし、経理のプロフェッショナルが群衆をわかせるエンターテイナーであることもほとんどない。
また、たとえもし何事にも優れている超人のような人がいたとしても、時間はすべての人に平等に与えられている。それゆえ、人々はたいていひとつの業種に特化し、社会的に分業をするのである。

その一例を見てみよう。

```{list-table} 比較優位と絶対優位
:header-rows: 1
:name: compara

* - 
  - 農産物
  - 工業製品
* - アダム
  - 5億
  - 10億
* - デイヴィッド
  - 4億
  - 3億
```

アダムとデイヴィッドがそれぞれ農産物と工業製品を作ることを考えている。{numref}`compara`では一年あたりで彼らが作ることができる価値を表している。
彼らが別々に農産物と工業製品を作ろうとすると、例えば半々に労力を割けば農産物は$2.5+2=4.5$億, 工業製品は$5+1.5=6.5$億の合計$11$億の価値である。これを仮にアダムは工業製品に注力し、デイヴィッドは農産物に注力すればどうなるだろうか。答えは次のとおりである。工業製品は$10$億、農産物は$4$億の合計$14$億になる。合計の価値を最大にするにはこうすることがベストである。
なぜならアダムは農産物一単位を生産する間に工業製品を二倍生産できるのに対し、デイヴィッドは逆に工業製品一単位を生産する間に農産物を$4/3$倍生産できるのである。それぞれが比較的得意な方に特化する方が全体ではより多く生産できる。このときアダムは工業製品の生産に*比較優位*があるといい、逆にデイヴィッドには農産物の生産に*比較優位*がある。
注意すべき点として、アダムは農産物の生産でも工業製品の生産でもデイヴィッドの生産性を上回っている。このときアダムは両方の生産に*絶対優位*があるという。こういった場合でもアダムが両方の財を生産しないのはアダムの時間が限られているからである。比較的劣る農産物の生産をすることで収益があまり上がらないならばその分野はデイヴィッドに任せてしまう方が良いのである。

このとき、アダムは工業製品だけを、デイヴィッドは農産物だけを手にする。しかし両者ともこれでは満足できないだろう。
お互い程々の量の工業製品を消費したいだろうし、農産物も程々の量を消費したい。このとき、彼らは余計に作った分、余剰生産物をお互いに交換して多種多様な財を消費することができる豊かな生活を送るのである。
さて、その余剰生産物をどこで交換するのだろうか。ひとつの答えは*市場*である。
経済学はこの市場とはさて、どれだけ素晴らしいシステムなのか、あるいは致命的な欠陥をもつものなのか、そして市場をどう扱えば我々の生活をさらに向上できるかという問いに答えを用意する。
この章ではまず第一歩として、財が一種類だけしかない市場とその役割を分析する。

(MARKET_SEC)= 
## 市場における交換


具体的に次の状況を考えてみよう。ここでは「家」の市場を考えてみよう。この市場には家を欲しがっている人々と、家を建てることができる人々（大工）がいる。登場人物は{numref}`market`のとおりである。上段が家が欲しい人、つまりこの市場では*買い手*となる人々である。彼らはそれぞれ*支払意思額*を持っている。支払意思額とは家を一軒買うときに支払っても良いと考えている金額の上限である。一方下段は大工、つまりこの市場では*売り手*となる人々である。彼らは家を一軒建てるのにそれぞれ表にある費用がかかる。今、買い手は家は最大でも一軒までしか欲しくないと思っているし、売り手も一軒しか建てられないとしよう。このときどのように買い手と売り手を取引させれば良いだろうか？

```{list-table} 家の取引
:name: market

* - 家が欲しい人 
  - 天照  
  - 出雲  
  - 高木  
  - 月読  
  - 大和   
* - 支払意思額（万円） 
  - 5000   
  - 3500  
  - 2000  
  - 1000  
  - 800

* -  
  -
  -
  -
  -
  - 
  

* - 大工  
  - アダム 
  - イヴ  
  - ルツ 
  - ヤコブ   
  - ヨセフ
* - 費用（万円） 
  - 4500 
  - 3200 
  - 1800 
  - 950 
  - 850 
```

適当に自由に売り手と買い手を取引させてやればいいと思うかもしれない。
例えば{numref}`market1`のように売り手と買い手が出会ったらどうだろうか（このように取引相手を組み合わせることを*マッチング*という）。

```{list-table} 適当なマッチング
:name: market1

* - 買い手 
  - 天照 
  - 出雲 
  - 高木 
  - 月読 
  - 大和   
* - 取引成立の可否
  - 💖
  - 💖
  - 💖
  - 💖
  - 💔
* - 売り手  
  - アダム 
  - イヴ  
  - ルツ 
  - ヤコブ   
  - ヨセフ 

```


このマッチングでは天照とアダムは取引できる。なぜなら天照の支払意思額は5000万円である一方、アダムは4500万円で家を建てられる。したがって、天照が5000万円から4500万円の間の金額を支払えば取引成立である。このときこの5000万円から4500万円を引いた額500万円を取引から得られる*余剰*と呼ぶ。天照が払う額を$p$万円とすれば天照は$5000-p$万円だけ得をしたと思うだろうし、アダムには$p-4500$万円の儲けが出る。天照が得をした分とアダムの儲けを合計した分が余剰である。そしてそれは$(5000-p)+(p-4500)=5000-4500=500$万円である。同様にして他の３つの組もうまく取引ができる。しかし大和とヨセフは取引ができない。大和は800万円しか支払意思額がないのにも関わらず、ヨセフは家を建てるのに850万円かかるからである。
さてこの取引で得られる余剰の合計は$500+300+200+50=1050$万円である。これを*社会的総余剰*と呼ぶ。

さて，こうしたマッチングはうまくいっているだろうか。ある視点ではそうかも知れない。このマッチングは取引件数を最大にしている。一方でこの取引に不満がある人がいる。ヨセフである。いまヨセフは次のような取引を天照に持ちかけたとしよう。「$1000$万円払ってくれたらアダムの代わりに僕が家を建ててあげるよ」。
天照がこの取引に応じてヨセフに$1000$万円払ったらどうだろうか。このとき天照の得した分は$5000-1000=4000$万円である。アダムと取引した場合には最大500万円であったのに対し、大幅増である。また、ヨセフにも利益がある。ヨセフは{numref}`market1`では取引できず、何の収入も得られなかったのに対し、今度の取引では150万円の儲けを手にすることができる。この二人の取引はメデタく成立する。

このような事が起きる原因はアダムが取引に参加していることである。彼は家を建てるのに4500万円もかかるという非常に非効率な大工である。彼が家を建てる代わりにヨセフというわずか850万円で効率的に家を建てられる大工が取引から押し出されているのである。

*市場取引*はこういったことから起きる非効率性を解決してくれる。では市場取引とはどういうものだろうか。
これを考えるために次の図を考えてみよう。{numref}`demand`における階段状の曲線は買い手の支払意思額を「高い順」に左から並べたものである。この曲線は*需要曲線*と呼ばれる。

```{figure} ./ch1_img/demand_ch1.png
:name: demand

需要曲線
```

これがなぜ需要曲線と呼ばれるのだろうか。これを考えるために「価格」というものを考える。例えば家の価格が3000万円だったとき、家を買うのは誰だろうか？答えは3000万円以上の支払意思額を持つ天照と出雲である。すると市場で売れるのは2軒ということになる。
ここで図中の需要曲線と3000万円を指す直線の交点を見てみるとちょうど数量が2になっている。つまり需要曲線とはある適当な価格を決めたときと売れる数量の関係を描いたものと言える。そして{numref}`demand`の需要曲線がそれであることはわかるだろう。このときの買いたい量のことを*需要量*と呼ぶ。

売り手の方も考えてみよう。{numref}`supply`の階段状の曲線は*供給曲線*と呼ばれる。これは売り手の一軒あたりの建設費用を「安い順に」左から並べたものである。供給曲線とは「価格が与えられたとき、どれだけ財が売りに出されるか」ということを指し示す曲線である。さしあたり価格を3000万円としてみよう。すると、この供給曲線によると「3人の大工が売りたいと思っている」ということがわかる。
このときの売りたい量のことを*供給量*と呼ぶ。
```{figure} ./ch1_img/supply_ch1.png
:name: supply

供給曲線
```

この二つの曲線を用いて、市場での取引が行われる。{numref}`equilibrium`を見てみよう。これは需要曲線と供給曲線を同じ図に描いたものである。この需要曲線と供給曲線が交わるところで*市場価格*が決定される。ここでの価格は*均衡価格*と呼ばれる。図で言えば2000万円から1800万円の間である。さてこの価格では需要量と供給量が一致している。このとき市場で取引が行われ、買い手は均衡価格でものを買い、売り手は均衡価格でものを売るのである。

```{figure} ./ch1_img/equilibrium_ch1.png
:name: equilibrium

市場均衡
```

さてこのとき、この取引で得られる余剰の大きさはいくらぐらいだろうか。仮に均衡価格が1900万円だったとしてみよう。この取引でものを買えるのは天照、出雲、高木の三人である。彼らの余剰の合計は$(5000-1900)+(3500-1900)+(2000-1900)=3100+1600+100=4800$万円である。（買い手の余剰の合計を*消費者余剰*と呼ぶ。）一方で、この取引でものを売れるのは費用が低い順でヨセフ、ヤコブ、ルツの三人である。彼らの余剰の合計は$(1900-850)+(1900-950)+(1900-1800)=1050+950+100=2100$万円である。（売り手の余剰の合計を*生産者余剰*と呼ぶ。）この二つの余剰を合計すれば社会的総余剰を計算することができる。そしてその値は$4800+2100=6900$万円である。{numref}`market1`の取引での余剰は950万円であったのでその差は歴然である。実は市場でのこのような取引方法は取引から得られる社会的総余剰を最大にする。そしてそれが市場における取引の利点である。

市場での取引に問題がないわけではない。市場での取引を見てみると取引成立件数が{numref}`market1`の取引では4件だったものが3件にまで減っている。これは非効率な売り手を排除した結果であるが、なにぶん不公平ではある。市場取引はこういった不公平感までは解消できない。したがって何らかの再分配などの措置がなされるべきであろう。

さてこの節では具体的な例を使って、市場の役割を見てきた。次節以降ではもっと一般的に市場の理論を展開していく。

(homo_demand)=
## 単一財の消費者理論

### 需要曲線の導出

前節では具体例を使って市場の役割を見てきた。本節以降ではより一般的な議論を行う。そのためにまずは需要曲線というものをもう一度きちんと定義したい。これをするために買い手（消費者ともいう）の行動から考えてみるべきである。需要曲線とは消費者の買いたい量であるので、その「買いたい」という気持ちがどこからきているのかということを真面目に取り扱わなくてはならない。その動機を解明してこそのミクロ経済学である。

さて、具体的に次のような消費者を考えてみよう。消費者は財を$q$だけ消費すると金銭に換算して$v(q)$だけの幸福感を覚えるとしてみよう[^note0]。一方、市場では財を$q$だけ購入することになるので、価格が$p$であったとすれば彼の幸福感の合計（記号を使って$u(q)$と書く）は金銭で測ると

```{math}
u(q)=v(q)-p\times q
``` 

だけということになるだろう。このときの値$u(q)$を*効用*と呼ぶ[^note1]

[^note0]: これは$v\times q$という意味ではない。「$v$は$q$の関数である」ということだ。例えば$v(q)=\sqrt{q}$などが一般的である。
[^note1]: そして関数$u$は*効用関数*と呼ばれる。効用の値そのものには大した意味はない。人々がどういう順序で選択肢を好むかを数値で表現したものが効用だということに過ぎない。人々の好みがどういう条件を満たすならば（特定の）効用関数で表現できるのかという問いについては意思決定理論という分野で研究されている。ギルボア(2014)「不確実性下の意思決定理論」勁草書房などを参照せよ。

消費者はこの効用の値を最大にするよう財の購入量、つまり$q$を決定する。さて、効用を最大化するにはどうすれば良いだろうか。

一番単純な、そしてほぼ万能な方法は「微分をすること」である。この関数$u$を購入量$q$で微分したとき、その値が$0$になることが「$u$を最大にする$q$を求めるため」の第一条件である。
早速微分してみよう。すると

```{math}
u'(q)=v'(q)-p
``` 

この値が$0$になれば良いので$u$を最大にする$q$ならば$v'(q)-p=0\iff v'(q)=p$が満たされる。
このときの$q$の値を$q^{*}$だとしてみよう。つまり$v'(q^{*})=p$が最大化条件だ。
直感的には次のとおりである。$v'(q)-p$というものは$q$を少し増やしたとき、$v'(p)$だけ財消費から得られる効用の増分から$p$だけの支払いの増加分を引いたものである。これが$0$より大きいのであればもっと購入すれば良いだろうし、$0$より小さいのであればもっと購入量を減らすべきである。最適な状態ではこの二つの効果が打ち消し合っている。

さてこれはどういう条件であろうか。これをみるために図に書いてみよう。{numref}`marginalutil`にあるように$v'(q)$は右下がりの曲線だとする。
すると$q^{*}$という点は$v'(q^{*})=p$となっているところ、つまり図中の黒点で求めることができる。

```{figure} ./ch1_img/marginalutil_ch1.svg
:name: marginalutil

効用最大化条件
```

こうしてみると各$p$に対する最適な購入量$q^{*}$\angl{買いたい量}は{numref}`marginalutil`の曲線$v'(q)$に沿うようにして求められる。そう、この曲線$v'(p)$がこの場合の需要曲線になるのである。$v'(p)$は{ref}`MARKET_SEC`で見た需要曲線と関連が深い。{ref}`MARKET_SEC`での需要曲線はいわば追加的な一単位に対する支払意思額といっても良い。買い手全員を一人の消費者と見なせばこの消費者は最初の一単位に5000万の価値を見出し、次の一単位に3500万円の価値を見出している。つまり追加的な一単位に出してもいい金額を指しているのである。
$v'(q)$も似たような概念である。$v(q)$はいわば財$q$だけ消費することに$v(q)$円だけの価値を感じているということである。$v'(q)$というのは$q$が増えたとき、金銭価値$v(q)$が追加的にどれだけ増えるかを示す指標である。

さて、需要曲線を導出した後はこれを使って実際、価格が$p$のときどれだけ需要量があるのかを知りたいとなるだろう。これ以降は具体的に$v(q)=-q^{2}+2 q$として計算する。そうでない場合も同じようにして計算することができる。

```{math}
v'(q^{*})=-2q+2=p
```
となる。これを整理すると
```{math}
-2q^{*}+2=p\iff q^{*}=1-\frac{1}{2}p
```
となる。これをみると$q^{*}$は$p$の関数（一次関数）としてかけることがわかる。よってそれをわかりやすくするため$q^{*}$を$D(p)$で書く。(Demand の D)である。つまり$D(p)=1-\frac{1}{2}p$である。こういった関数を*需要関数*という。

消費者が複数いる場合、市場の需要関数は全ての消費者の需要関数を足し合わせる。このようなものは*総需要関数*と呼ばれる。

ひとつ注意するべきは，需要曲線のグラフを描くとき，価格を縦に，数量を横にとることである．これは効用最大化条件の図{numref}`marginalutil`を見るとわかる．
こう見ると需要関数は価格の関数ではなく数量の関数に見えるかもしれません．実際価格と需要量の関係が一対一であれば[^note5]需要関数を反転させることができます．

[^note5]:一対一とは価格が違えばそのときの需要量は異なり，また量が違えば，需要量がその量になる価格も違うということです．}，


もし需要関数が$D(p)=a \times p+b$と書けるとします．このとき，$ q=D(p)$, $ p=P(q)$とおけば需要関数を$q=a \times P(q)+b$と書き直すことができます．この$P(q)$の部分が価格です．これを数量の関数とみなすのです．これを解けば$P(q)=\frac{1}{a}(q-b)$と書き換えることができます．この$ P(q)$は*逆需要関数*と呼ばれます．経済学では需要関数を図示するとき，逆需要関数の方を書くのです．

### 需要の価格弾力性

需要関数に関係して，*需要の価格弾力性*という概念を紹介します．需要の価格弾力性とは価格が$1\%$変化したときに需要は何$\%$変化するかという指標で，需要関数を$D(p)$，変化前の価格を$p^{\text{前}}$，変化後の価格を$p^{\text{後}}$とすれば
```{math}
\text{需要の価格弾力性}&=-\frac{\frac{D(p^{\text{後}})-D(p^{\text{前}})}{D(p^{\text{前}})}}{\frac{p^{\text{後}}-p^{\text{前}}}{p^{\text{前}}}}\\
& =-\frac{D(p^{\text{後}})-D(p^{\text{前}})}{p^{\text{後}}-p^{\text{前}}}\times \frac{p^{\text{前}}}{D(p^{\text{前}})}
``` 
と定義されます．つまりは需要の変化率$ \frac{D(p^{\text{後}})-D(p^{\text{前}})}{D(p^{\text{前}})}$を価格の変化率$ \frac{p^{\text{後}}-p^{\text{前}}}{p^{\text{前}}}$で割ったものです.

変化率とは，変化した分の差を変化する前の量で割ったものです．なぜこんなことをするのかと言えば，変化した分の差だけ見てもイマイチどれだけその変化のインパクトが大きいかがわからないからです．例えば価格$1000$万円のものが$ 1001$万円になったとして，たいした変化ではないですが，$10$円のものが$1$万$10$円になったら大ニュースです．しかしこの場合どちらも変化した大きさは１万円です．一方で変化率で見ると，前者の変化率は$\frac{\text{1万}}{\text{1000万}}=0.001$ですが，後者の変化率は$ \frac{\text{1万}}{10}=1000$です．変化率がインパクトの大きさの違いを表していますね．通常は価格が低下すると需要が増えるので，変化率はマイナスになります．したがってマイナスをつけて絶対値で表現することがよくあります．（これは本質的ではありませんが）．

例として，需要関数が一次関数，$D(p)=b-a \times p$だとします．すると価格弾力性は次のように計算できます．
```{math}
\text{需要の価格弾力性}&= -\frac{(b-a \times p^{\text{後}})-(b-a \times p^{\text{前}})}{p^{\text{後}}-p^{\text{前}}}\frac{p^{\text{前}}}{(b-a \times p^{\text{前}})}\\
&= \frac{a \times p^{\text{前}} }{ b-a \times p^{\text{前}}}
```
少し観察すればわかるように例えば需要関数の傾き$a$が大きければ大きいほど大きくなります.

逆需要関数の傾きとしては逆に傾きが小さい財が弾力性の高い財です．通常目にする需要曲線は逆需要関数ですので，弾力性の大きい財は水平に近い傾きをしています．また価格が大きい財もより弾力的になります．

価格弾力性が$1$を超えるものを弾力的な財と呼び，そうでない財を非弾力的な財と呼びます．弾力的な財であれば少しの価格変化で需要が大きく動きます[^note2]．贅沢品（奢侈品）などがそうです．非弾力的な財の例としては必需品や中毒性のある財などがあります．

[^note2]: グラフを見て弾力的かどうかを判断するにはこの点に注意すると分かりやすいです．

(homo_supply)= 
## 単一財の生産者理論

(supply_sec)=
### 供給曲線の導出

売り手（あるいは生産者）についても消費者のものと同じような議論を行う。いま売り手は$q$だけの財を作るのに費用が全部で$C(q)$だけかかるとしてみよう[^note3].
[^note3]:正確には$q$だけ作るための*最小の*費用である。下手な作り方をしていれば$q$だけ作るためにいくらでも支出できるが、費用が最小にならない作り方をする意味は（基本的には）ないからである。（利益供与などの不正をする場合などは除く）

これは *（総）費用関数*と呼ばれるものである。一方で$q$だけ作る分、売り手には収入がある。作った財が価格$p$で売れるものだとすると彼の儲け（*利潤*と呼ぶ）は次のとおりである。
```{math}
\pi(q)=\underbrace{p\times q}_{\text{収入}}- \underbrace{C(q)}_{\text{費用}}
```

当面は売り手はこれを最大化するものだとする。買い手の場合と同様に利潤$\pi(q)$を$q$で微分することで最大化を図って見よう。
微分すれば
```{math}
\pi'(q)=p-C'(q)
```
となる。この値が$0$になれば良いので$\pi$を最大にする$q$ならば$p-C'(q)=0\iff p=C'(q)$が成立する。$C'(q)$は*限界費用*と呼ばれる。つまり追加的に一単位生産するときに余計にかかる費用のことである。これも{ref}`MARKET_SEC`での供給曲線との関連を指摘できる。{ref}`MARKET_SEC`での売り手全体を一人の売り手だと思ったとき、最初の一単位を生産するには850万円でいい。しかし次の一単位を生産しようと思うと一番の大工ヨセフはすでに仕事中であるので二番手のヤコブに任せるしかなく、そのときには追加的に950万円かかるのである。限界費用もこれと似たような概念である。生産量を増やそうと思うとコストが増えるのは間違いないが、$C'$はその追加的な増分がどれだけの大きさかを示している。

さてこれも図に書いて見よう。{numref}`marginalcost`を見ればわかるように需要曲線の場合と同様に価格をひとつ決めるとそれに対応する最適生産量$q^{*}$を見つけることができる。

```{figure} ./ch1_img/marginalcost_ch1.svg
:name: marginalcost

利潤最大化条件
```
また価格と最適生産量の組み合わせは必ず曲線$C'(q)$上にある。これがこの場合の供給曲線となる。

さて需要関数の場合と同様に*供給関数*も導出することができる。これは価格が$p$であったとき、どれだけ生産したいかを示す関数である。具体的に$C(q)=q^{2}$であるとしよう。
$q^{2}$を微分したものは$2q$であるので、これを利潤最大化条件に代入する。
```{math}
p=C'(q^{*})\iff p=2q^{*}\iff q^{*}=\frac{1}{2}p
```
これをみると最適生産量$q^{*}$もやはり$p$の関数（一次関数）として書ける。よってその関係をわかりやすくするため$S(p)$とかく。（Supply の S）である。この例だと$S(p)=\frac{1}{2}p$である。こういった関数は*供給関数*と呼ばれる。

生産者が複数いる場合、市場の供給関数は全ての生産者の供給関数を足し合わせる。このようなものは*総供給関数*と呼ばれる。

### 費用の構造

さて前節では生産にかかる費用を$C$という関数で置き、ブラックボックス的に扱ってきたが、では現実ではどのようなものが費用に当たるのかを考えて見よう。

まず思い当たるのは原材料費、燃料代、電気代や人件費といったものである。これは生産量を増やせば増やすほど増大していくものだと考えられる。こういった生産量を変化させれば変えられる費用のことを*可変費用*と呼ぶ。


可変費用に対して、工場や機械など一度導入してしまえば（管理費や消耗による修繕費などはかかるものの）生産量によらず一定でかかる費用もある。こういった費用を*固定費用*と呼ぶ。

工場や機械などを固定費用と呼ぶことには次の批判がありそうだ。「本当に生産するつもりがないんだったらそもそも工場なんか建てなければいいのでは？」実際、長い目で見てみれば、生産する気がないのであれば工場や機械などは売却してしまえば費用（の一部）は回収できる。しかし短い目で見てみればこれらは融通性がない。こういうものは一日二日で売れるものではないし、速やかに現金に変えたいのだとしたらそれこそ二束三文で売ることになり、建てるのにかかった費用のほんの一部しか回収できない。結果生産を一切しないのに費用だけがかかるということになりかねない。

この議論で言えることは何が固定費用かは時間の長さによるということだ。人件費だって雇用調整がうまくいかなければ生産量を少なくしても余分な人員を抱えることになるが、その分給与も払わなければいけないので生産量に関係なく費用がかかることになる。
しかし10年や20年という長い目で見ればそういった調整は可能であろう。
こういうようにあらゆる費用が生産量に応じて調整できるような長い期間のことを経済学では*長期*と呼ぶ。そうでなく、一部回収不能な固定費用が生じてしまうような状態は経済学では*短期*である。

今まで見てきた費用の例は原材料費や人件費などの*会計上の費用*である。一方で会計上ではカウントされないが経済学的には費用とみなされるものがある。例えばある工場をパック牛乳を作るのに使っていたとしよう。ところがこの工場はほとんど費用をかけることなく羊羹を作る工場に変えることができる。羊羹を作っていたときに稼いでいたはずの利潤も費用なのである。何故ならばもし羊羹を作っていたときに稼いでいたはずの利潤が牛乳工場で得られる利潤を上回っているならば牛乳でなく羊羹を作るべきである。牛乳を作ることで諦めた利潤、つまり羊羹を作れば得られていたであろう利潤の分も費用としてカウントしてやらないと利潤最大化はうまくいかないのである。
このように他に使い道があったのに現在の使い道にすることで失う利益のうち最大のものを*機会費用*という。
経済学では会計上の費用に加えて機会費用も経済学上の費用とみなす。

さて費用関数に対応させて見よう。例えば$C(q)=q^{3}+q^{2}+q+5$という関数では何が可変費用でどれが固定費用だろうか。生産量に応じて変化する部分が可変費用であるので$q^{3}+q^{2}+q$の部分が可変費用であり、全く生産しなくてもかかる費用（つまり$q=0$のときの費用）が固定費用であるので固定費用は$5$である。固定費用はいわば$C(0)$と書くことができる。可変費用はその残りの部分$C(q)-C(0)$である。

ところで前節の議論を見ればわかるが、固定費用は最適な生産量の決定には全く関係がない。どれだけ費用を調整しようとすでに払ってしまった費用が短期的には戻ってくることはないからだ。このようにすでに支払ってしまってもう取り返しがつかない費用のことを*埋没費用*[^note6]と呼ぶ。ただし固定費用の中身によっては埋没費用にならない場合もある。工場などは長期的には売り払ってしまえば費用の一部は回収できるからである[^note7]。

[^note6]: 英語では sunk cost という。
[^note7]:別の用途に使える場合も同様に埋没費用とはみなされない。完全に他の用途にも使えず、回収できないものが埋没費用とみなされる。

世の中にはあるプロジェクトについて、「すでにこれだけ費用をかけてしまったのだから、いくら失敗濃厚といったとしてもそのプロジェクトをやるしかない」と主張する人がいる。これは全くの誤りである。すでにかけた費用は回収できないので回収できる範囲でプロジェクトをするかどうかを決めるべきなのである。こういうものを*埋没費用の誤謬*という[^note8]。

[^note8]: ところでこういう発想にも利点がある。例えば運動不足解消のためにジムに年間会費を一括で支払う場合を考えて見よう。あとでめんどくさくなったとしたら、たとえ支払ってしまっていても通わなくなるというのが``最適''な判断である。勿体ないからといって面倒でも通い続けるのは埋没費用の誤謬に囚われているのである。しかし「運動不足を解消したい過去の自分」からすれば面倒でも通い続けるのが良いだろう。このようにサボりたいというような誘惑がある場合には埋没費用の誤謬がプラスに働くのである。

固定費用は利益が赤字か黒字かという分析には関わってくる。利潤が黒字になるのは以下の不等式が成立するときである。
```{math}
p\times q> C(q)
```
一方で以下の不等式が成立するときには赤字である。
```{math}
p\times q<C(q)
```
そして次の等式が成立するとき、利潤が$0$となる。
```{math}
p\times q=C(q)
```
上の式の両辺を$q$で割ると
```{math}
p=\frac{C(q)}{q}
```
となるが、このときの価格を*損益分岐点*の価格、生産量を損益分岐点の生産量と呼ぶ。$\dfrac{C(q)}{q}$は生産一単位あたりの費用なので{平均費用}と呼ばれる。

価格が損益分岐点を下回ったとしても生産をやめるべきではないかもしれない。可変費用の部分で黒字であれば固定費用による赤字を減少させることができるからだ。可変費用を$VC(q)$とおけば
```{math}
p\times q>VC(q)
```
である限り、一単位生産するごとに利益が生まれる。生産を続けて赤字がマシにならなくなるのは
```{math}
p\times q\le VC(q)
```
であるときだ。このときは生産するよりも$q=0$にした方が利潤はマシである。
したがってその境界、
```{math}
p\times q=VC(q)\iff p=\frac{VC(q)}{q}
```
となる価格を*操業停止点*の価格、そのときの生産量を操業停止点の生産量と呼ぶ。$\frac{VC(q)}{q}$は平均可変費用と呼ばれる。

さて損益分岐点と操業停止点をそれぞれ求めてみよう。価格$p$が与えられたときの最適な生産量は$p=C'(q)$を満たすということを思い出してもらいたい。

したがって損益分岐点の生産量$\hat q$では
```{math}
C'(\hat q)=\frac{C(\hat q)}{\hat q}
```
が満たされる。

同様に操業停止点の生産量$\tilde q$では
```{math}
C'(\tilde q)=\frac{VC(\tilde q)}{\tilde q}
```
が満たされる。

図で言えば{numref}`cost`のとおりである。


```{figure} ./ch1_img/cost_ch1.svg
:name: cost

損益分岐点と操業停止点
```

###  注意
{ref}`supply_sec`では供給曲線は限界費用曲線そのものだと述べたがこれには注意が必要である。もし操業停止点の価格が正であるならばそれ以下の価格では生産量を$0$にしなければならないからだ。したがって供給曲線は限界費用曲線の「操業停止点より右上の部分」ということになる。それ以下では生産量は常に$0$だ。


```{figure} ./ch1_img/supplycurve_ch1.svg
:name: supplycurve

供給曲線
```


## 市場均衡と余剰

{ref}`MARKET_SEC`でやったものと同様に{ref}`homo_demand`および{ref}`homo_supply`で導いた需要曲線と供給曲線を用いて市場均衡を導こう。

図で書くと簡単である。{numref}`partialequilibrium`を見よう。図にある通り、需要曲線と供給曲線の交点で市場均衡が決まる。市場均衡における価格$p^*$を*市場均衡価格*といい、このときの取引量$q^*$を*均衡取引量*と呼ぶ。
```{figure} ./ch1_img/partialequilibrium_ch1.svg
:name: partialequilibrium

市場均衡
```


需要関数と供給関数を使っても求めることができる。需要曲線と供給曲線が交わっている点ではその価格での需要量と供給量が一致しているということを意味する。したがって均衡では$D(p)=S(p)$が成立している。この方程式を解くことで導かれる価格$p^*$が均衡価格であり、その点での取引量$D(p^*)=S(p^*)=q$が均衡取引量である。

例として、$D(p)=4-p$, $S(p)=p+2$であったとしよう。この二つが一致するとは$4-p=p+2$が成り立つことであり、これを$p$について解けば$p=1$となる。これが均衡価格である。そして均衡価格を需要関数（または供給関数）に代入すれば$D(1)=4-1=3$となり、これが均衡取引量である。

社会的総余剰についても{ref}`MARKET_SEC`のときと同様に求めることができる。{ref}`MARKET_SEC`のときの消費者余剰は各買い手の支払意思額から価格を引いたものの合計したものだった。{numref}`surplus`で言えば需要曲線の下側、価格の上側、取引量の左側で囲まれた部分の面積がそれに当たる。同様に生産者余剰は価格から一軒あたりの費用を差し引いたものの合計である。{numref}`surplus`で言えば供給曲線の上側、価格の下側、取引量の左側で囲まれた部分の面積である。

```{figure} ./ch1_img/surplus_ch1.svg
:name: surplus

取引余剰
```
{numref}`partialequilibrium`のような需要曲線と供給曲線についても同様に余剰を定義することができる。（{numref}`surplus2`参照）

```{figure} ./ch1_img/surplus2_ch1.svg
:name: surplus2

取引余剰
```

このようなタイプの余剰を実際に計算するにはどうしたら良いだろうか。ひとつの方法は、余剰は結局均衡点における効用と利潤の和であるから均衡で求まった数量と価格を効用関数$u(q)=v(q)-p\cdot q$と利潤関数$\pi(q)=p\cdot q-C(q)$に代入すればそれぞれが消費者余剰と生産者余剰になる。そしてその合計$(v(q)-p\cdot q)+(p\cdot q-C(q))=v(q)-C(q)$が社会的総余剰である。

しかし効用関数や費用に関する情報が与えられていない場合もあるかもしれない。この場合、需要関数と供給関数を使って面積を計算することを考える。
例えば需要関数が$D(p)=3-p$、供給関数が$S(p)=p-2$と与えられていたとしよう。需要曲線、供給曲線は縦軸が価格であるのでそれぞれ$p=$のかたちになおして、需要曲線は$p=3-D(p)$, 供給曲線は$p=S(p)+2$となる。これを図に描いて面積を計算するのである。


最後に市場均衡での取引では社会的総余剰が最大化されるということを確認しておこう。ここで社会的総余剰とは消費者余剰と生産者余剰の合計$(v(q)-p\cdot q)+(p\cdot q-C(q))=v(q)-C(q)$である。これを最大にする取引量$q$とはいくらだろうか？
答えはこの関数を最大化することで求まる。$v(q)-C(q)$を最大化するにはこれを$q$で微分すれば良い。そうして出た値が$0$になるのが必要条件だ。
これをやってみると$v'(q)-C'(q)=0\iff v'(q)=C'(q)$という式が条件になる。

一方で市場均衡では{ref}`homo_demand`および{ref}`homo_supply`節でみてきたように$v'(q)=p$かつ$p=C'(q)$が満たされなければならない。この二つの式から$v'(q)=p=C'(q)$、すなわち$v'(q)=C'(q)$が言える。これは社会的総余剰最大化の条件と一致する。

## 市場均衡分析の応用

### 需要曲線・供給曲線のシフト

### 豊作貧乏

### 需要法則の検証


## 課税と死荷重損失

市場取引を通じた均衡では余剰が最大化されることがわかった。一方で我々が普段財を購入する市場では税が課されている。この節では課税がどのような影響をもたらすのかを簡単に見てみよう。

課税には消費税、所得税、法人税などいろいろあるが、ここでは財の購入に税が課されるものとしよう。一単位購入するごとに$t$円を税として支払わなければならないとする。こういったタイプの課税を*従量税*と呼ぶ[^note9]。
つまり消費者は$q$だけ財を購入すると$(p+t)\times q$だけ支払わなくてはならない。これは価格が実質$p+t$になったようなものである。


[^note9]:日本の消費税は価格に比例するタイプの税である。つまり消費者の支払額は$(1+\tau)\times p\times q$となる。（$\tau$は税率）こういうタイプの税を*従価税*と呼ぶ。

一方で生産者の方は$p\times q$だけ受け取る。$t\times q$の部分は税収となり政府の懐に入る。この事実からわかることは消費に課税すると消費者と生産者が直面する価格が変わるということである[^note10]．

[^note10]:生産に課税しても同じ。

社会的総余剰の最大化条件は$v'(q)=C'(q)$であった。
いま、課税がなされている状況で消費者の効用最大化条件から導かれるのは$v'(q)=p+t$という条件である。消費者にとっての価格は$p+t$に変わってしまっているからだ。一方で生産者にとっての条件は$p=C'(q)$のままである。したがって
```{math}
v'(q)=p+t>p=C'(q)
```
となり、社会的総余剰最大化条件と一致しない。したがって課税があれば市場での余剰最大化はうまく行かない[^note11]．

[^note11]: この場合、生産量が過少になる。これはなぜか確かめてみよ。(少し難)

このことを図を用いて確かめてみる。
課税のある場合の均衡を図示すると{numref}`tax`のようになる。

```{figure} ./ch1_img/tax_ch1.svg
:name: tax

従量税の影響
```

消費者の直面する価格は$p^*+t$であるが、生産者の直面する価格は$p^*$である。それらの価格のもとでの需要量と供給量が一致する場合が均衡である。需要関数と供給関数を使って書くと$D(p^*+t)=S(p^*)$となる価格が均衡価格になる。{numref}`tax`における四角形の部分は税収を表している。税収も余剰に含めるとしても余剰の合計は減少している。その減少した余剰のことを課税による*死荷重損失*と呼ぶ。

### どのような財に課税すべきか

従量税を課すと死荷重損失が出ることは見てきた。これは課税が社会にどれだけ悪さをしているかを表す一つの指標となる。では課税（一定額の税収）がどうしても必要なとき、そしてそれが従量税でなくてはならないとき、どのような財に課税するのが良いのだろうか。この問題は*最適課税理論*という財政学の一分野で研究されている問題である[^note12]。
ここでは極めて簡単な場合を考えよう。

[^note12]: 詳しくは財政学や公共経済学の教科書を参照せよ。最適課税論の教科書としては洋書であるが、Salanié (2011) _the Economics of Taxation_, 2nd ed., MIT press がある。

まず、供給曲線を水平にする。そして均衡点を基準に需要曲線を回転させて、傾きの異なる需要曲線を比較する。これを見たのが{numref}`optax1`である。一段目左図を基準に需要曲線を水平にしたものが右の図であり、より傾きを急にしたのが二段目の図である。これを見ると、傾きを水平にしたものは死荷重損失が税収に比べてはるかに多い。一方、傾きを急にした図では死荷重損失は税収と比べてみても少ない。したがって同じだけ従量税を課すならば税収に比べて死荷重が少ない、傾きが急な財に課税すべきであるということだ。

では需要曲線の傾きが急な財とはどのような財であろうか。これは価格が変化しても需要量の減りが少ない財である。{numref}`optax1`をみてもわかるように傾きが急な需要曲線をみた図では課税前の均衡取引量$q^{\text{前}}$と課税後の取引量$q^{*}$の差は比較的小さいが、傾きが水平に近い需要曲線の場合にはその差ははるかに大きい。このように価格の変化に対して需要量が変化しにくい財、つまり傾きが急な需要曲線を持つは*必需財*と呼ばれている。一方で、価格の変化に対して需要量が大きく変化しやすい、水平に近い需要曲線を持つ財は*奢侈財*と呼ばれる。
この分析が示すことは、奢侈財よりも必需財に課税すべきであるということだ[^note4].

[^note4]:これを考案者の名前をとってラムジールールと呼ぶ。

もちろんこの分析は考慮すべき要素をいくつも省いている。ここで考慮しなかったことを含めればどのような財に課税すべきという結論になるかは最適課税論の重大な論題のひとつである。

```{figure} ./ch1_img/optax1_ch1.svg
:name: optax1

死荷重損失の比較
```