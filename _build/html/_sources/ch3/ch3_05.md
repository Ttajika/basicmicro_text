## 効用最大化問題
さて、分析のための道具を準備したところで消費者の問題に戻る。
繰り返すが、消費者の意思決定問題は次のような制約付きの最大化問題である。
%\begin{screen}

「消費者は予算制約の中で効用を最大化する消費プランを選ぶ.」

%\end{screen}

ここでは図を用いてその条件を導こう[^note20]。

[^note20]: ラグランジュの未定乗数法などを使って解析的にこの問題を解くこともできる．ラグランジュの未定乗数法については経済数学などの教科書を参照せよ．
 
 さて、次の{numref}`utilitymax`の中で効用を最大化する消費プランはどれだろうか?
```{figure} ch3_img/utilitymax.svg
:name: utilitymax

効用最大化問題
```


その答えは予算制約線と無差別曲線が接する点（図中の二重丸の点）である。
なぜ無差別曲線と予算線の接点が予算の中で効用を最大化するのだろうか。
その理由は次のとおりである。もし接しないとすれば次のパターンが考えられる。
1. 消費プランを通る無差別曲線が予算線と一度も交差しない。
例えば図中の点Aである。この場合、そもそも予算内に収まっていないので論外である。
したがって、予算内でより良い消費プランを見つけられるはずである。
 
1. 消費プランを通る無差別曲線が予算線と二回交差している。
例えば図中の点Bである。これは予算線よりも厳密に左下の領域に消費点が入る事を意味する。
したがって、その点よりも少し右上に行けば予算内でより良い消費プランを見つけられる。

このように無差別曲線と接していない点ではより良い改善点が見つかるので最適ではないのである。
 


%\begin{tikzpicture}
%\draw (0,0)--(4,0);
%\draw (0,0)--(0,4);
%  {\draw[very thick] (.8,3.5) to [out=280, in=135] (1.7,1.7) to [out=315, in=170] (3.5,.8);}
%  {\draw[very thick] (0,2.5) to [out=280, in=135] (.7,.7) to [out=315, in=170] (2.5,0);}
%
% {\draw[very thick] (.5,3.5) to [out=280, in=135] (1.5,1.5) to [out=315, in=170] (3.5,.5);}
% {\draw[very thick] (.2,3.5) to [out=280, in=135] (1.2,1.2) to [out=315, in=170] (3.5,.2);}
%\draw (3,0)--(0,3);
%
%\fill (1.5,1.5) circle (.05);
%\draw (1.5,1.5) circle (.1);
%
%\end{tikzpicture}

さてこの事実を使って効用最大化問題についてより考えを進めてみよう。
次の点に注意してほしい。予算制約線と無差別曲線が接しているとき, これらの２つの曲線の傾きは一致する。
予算制約の傾き（の絶対値）は $\frac{p_x}{p_y}$ である。
また無差別曲線の傾き（の絶対値）は$\textit{MRS}_{xy}=\frac{MU_x}{MU_y}$である。

したがって効用最大化点ではこの二つが一致する。つまり効用最大化条件は以下の通りである。
%\begin{screen}
```{math}
\underbrace{\textit{MRS}_{xy}=\frac{MU_x}{MU_y}=\frac{\frac{\partial u(q_x,q_y)}{\partial q_x}}{\frac{\partial u(q_x,q_y)}{\partial q_y}}}_{\text{限界代替率}}=\underbrace{\frac{p_x}{p_y}}_{\text{価格比}}
```
%\end{screen}


 効用最大化条件, 「限界代替率$=$価格比」は次のように解釈できる。
効用最大化条件を次のように変形する。
```{math}
\frac{MU_x}{MU_y}=\frac{p_x}{p_y}
\iff \frac{MU_x}{p_x}= \frac{MU_y}{p_y}
```
$1/p_{x}$は１円で購入できる財$x$の量で$1/p_{y}$は１円で購入できる財$y$の量である。
つまり$ \frac{MU_x}{p_x}$は最後の1円を財$x$に使ったときの追加的効用であり、$ \frac{MU_y}{p_y}$は最後の1円を財$y$に使ったときの追加的効用である。
 （通常の）効用最大化問題では予算を使い尽くすことに注意してほしい。
 $\frac{MU_x}{p_x}>\frac{MU_y}{p_y}$なら$y$の消費を少なくし, $x$の消費を増やせば効用が増えるので効用最大化してないのである。
 もし逆の不等式が成立するならば逆のことを行えばやはり効用最大化してないことがわかる。結果、効用最大化しているならば$\frac{MU_x}{p_x}= \frac{MU_y}{p_y}$が成立していなければならないのである。



ただし、限界代替率=価格比が効用最大化を意味しないケースも有る。ひとつは**端点**になるケース，つまりひとつの種類だけの財ばかり消費した方が良い場合がある。例えば同じ種類のコメ1俵の袋が1万円、コメ1斗缶が2000円で売っていたならば量的には1俵$=$4斗であるので，あなたが量しか気にしないのであれば，量あたりの値段が安い一斗缶の方ばかりを買うべきなのである。

もうひとつのケースでは飽和点がある場合である。この場合、予算を余していたとしても飽和点で購入する方が良いので先ほどの議論は当てはまらない。


### 需要関数
 各価格と所得の組について, 効用を最大化する消費プランを割り当てる関数のことを**需要関数**と呼ぶ。 需要は各財についてあるので, 財$x$の需要を$ d _x(p _x,p _y,I)$と書き, 財$ y$の需要を$ d _y(p _x,p _y,I)$と書く。
簡単に需要関数を求めてみよう。効用関数が$u(q_x,q_y)=(q_x)^{1/3}(q_y)^{2/3}$であったとする。
限界代替率は$MRS_{xy}=\dfrac{1}{2}\dfrac{q_y}{q_x}$と計算できるのであった。
効用最大がなされるとき、限界代替率と価格比が一致しなければならないので
```{math}
\dfrac{1}{2}\dfrac{q_y}{q_x}=\frac{p_x}{p_y}
```
となる。この式を変形すると
```{math}
p_yq_y=2p_xq_x
```
が得られる。効用最大化問題の解は制約条件、つまり予算制約を満たさなければならない。予算制約は$p_xq_x+p_yq_y=I$であったのでこの式に先程の条件$p_yq_y=2p_xq_x$を代入すると
```{math}
p_xq_x+2p_xq_x=I\\
\Rightarrow q_x=\frac{I}{3p_x}
```
となる。これが財$x$の需要関数$d _x(p _x,p _y,I)$である。
つまり$d _x(p _x,p _y,I)=\dfrac{I}{3p_x}$となる。
同様にして財$y$の需要関数は
```{math}
d _y(p _x,p _y,I)=\frac{2I}{3p_y}
```
である。





