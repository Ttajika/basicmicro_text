


## 市場均衡と余剰

[市場における交換](ch1.2.md)でやったものと同様に[単一財の消費者理論](ch1.3.md)および[単一財の生産者理論](ch1.4.md)で導いた需要曲線と供給曲線を用いて市場均衡を導こう。

図で書くと簡単である。{numref}`partialequilibrium`を見よう。図にある通り、需要曲線と供給曲線の交点で市場均衡が決まる。市場均衡における価格$p^*$を**市場均衡価格**といい、このときの取引量$q^*$を**均衡取引量**と呼ぶ。
```{figure} ./ch1_img/partialequilibrium_ch1.svg
:name: partialequilibrium

市場均衡
```


需要関数と供給関数を使っても求めることができる。需要曲線と供給曲線が交わっている点ではその価格での需要量と供給量が一致しているということを意味する。したがって均衡では$D(p)=S(p)$が成立している。この方程式を解くことで導かれる価格$p^*$が均衡価格であり、その点での取引量$D(p^*)=S(p^*)=q$が均衡取引量である。

例として、$D(p)=4-p$, $S(p)=p+2$であったとしよう。この二つが一致するとは$4-p=p+2$が成り立つことであり、これを$p$について解けば$p=1$となる。これが均衡価格である。そして均衡価格を需要関数（または供給関数）に代入すれば$D(1)=4-1=3$となり、これが均衡取引量である。

社会的総余剰についても[市場における交換](ch1.2.md)のときと同様に求めることができる。[市場における交換](ch1.2.md)のときの消費者余剰は各買い手の支払意思額から価格を引いたものの合計したものだった。{numref}`surplus`で言えば需要曲線の下側、価格の上側、取引量の左側で囲まれた部分の面積がそれに当たる。同様に生産者余剰は価格から一軒あたりの費用を差し引いたものの合計である。{numref}`surplus`で言えば供給曲線の上側、価格の下側、取引量の左側で囲まれた部分の面積である。

```{figure} ./ch1_img/surplus_ch1.svg
:name: surplus

取引余剰
```
{numref}`partialequilibrium`のような需要曲線と供給曲線についても同様に余剰を定義することができる。（{numref}`surplus2`参照）

```{figure} ./ch1_img/surplus2_ch1.svg
:name: surplus2

取引余剰
```

このようなタイプの余剰を実際に計算するにはどうしたら良いだろうか。ひとつの方法は、余剰は結局均衡点における効用と利潤の和であるから均衡で求まった数量と価格を効用関数$u(q)=v(q)-p\cdot q$と利潤関数$\pi(q)=p\cdot q-C(q)$に代入すればそれぞれが消費者余剰と生産者余剰になる。そしてその合計$(v(q)-p\cdot q)+(p\cdot q-C(q))=v(q)-C(q)$が社会的総余剰である。

しかし効用関数や費用に関する情報が与えられていない場合もあるかもしれない。この場合、需要関数と供給関数を使って面積を計算することを考える。
例えば需要関数が$D(p)=3-p$、供給関数が$S(p)=p-2$と与えられていたとしよう。需要曲線、供給曲線は縦軸が価格であるのでそれぞれ$p=$のかたちになおして、需要曲線は$p=3-D(p)$, 供給曲線は$p=S(p)+2$となる。これを図に描いて面積を計算するのである。


最後に市場均衡での取引では社会的総余剰が最大化されるということを確認しておこう。ここで社会的総余剰とは消費者余剰と生産者余剰の合計$(v(q)-p\cdot q)+(p\cdot q-C(q))=v(q)-C(q)$である。これを最大にする取引量$q$とはいくらだろうか？
答えはこの関数を最大化することで求まる。$v(q)-C(q)$を最大化するにはこれを$q$で微分すれば良い。そうして出た値が$0$になるのが必要条件だ。
これをやってみると$v'(q)-C'(q)=0\iff v'(q)=C'(q)$という式が条件になる。

一方で市場均衡では[単一財の消費者理論](ch1.3.md)および[単一財の生産者理論](ch1.4.md)でみてきたように$v'(q)=p$かつ$p=C'(q)$が満たされなければならない。この二つの式から$v'(q)=p=C'(q)$、すなわち$v'(q)=C'(q)$が言える。これは社会的総余剰最大化の条件と一致する。
