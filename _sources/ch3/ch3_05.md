## 効用最大化問題
さて、分析のための道具を準備したところで消費者の問題に戻る。
繰り返すが、消費者の意思決定問題は次のような制約付きの最大化問題である。
%\begin{screen}

「消費者は予算制約の中で効用を最大化する消費プランを選ぶ.」

%\end{screen}

ラグランジュの未定乗数法などを使って解析的にこの問題を解くこともできるが、ここでは図を用いてその条件を導こう。
 
 さて、次の{numref}`utilitymax`の中で効用を最大化する消費プランはどれだろうか?
```{figure} ch3_img/utilitymax.svg
:name: utilitymax

効用最大化問題
```


その答えは予算制約線と無差別曲線が接する点（図中の二重丸の点）である。
なぜ無差別曲線と予算線の接点が予算の中で効用を最大化するのだろうか。
その理由は次のとおりである。もし接しないとすれば次のパターンが考えられる。
1. 消費プランを通る無差別曲線が予算線と一度も交差しない。
例えば図中の点Aである。この場合、そもそも予算内に収まっていないので論外である。
したがって、予算内でより良い消費プランを見つけられるはずである。
 
1. 消費プランを通る無差別曲線が予算線と二回交差している。
例えば図中の点Bである。これは予算線よりも厳密に左下の領域に消費点が入る事を意味する。
したがって、その点よりも少し右上に行けば予算内でより良い消費プランを見つけられる。

このように無差別曲線と接していない点ではより良い改善点が見つかるので最適ではないのである。
 


%\begin{tikzpicture}
%\draw (0,0)--(4,0);
%\draw (0,0)--(0,4);
%  {\draw[very thick] (.8,3.5) to [out=280, in=135] (1.7,1.7) to [out=315, in=170] (3.5,.8);}
%  {\draw[very thick] (0,2.5) to [out=280, in=135] (.7,.7) to [out=315, in=170] (2.5,0);}
%
% {\draw[very thick] (.5,3.5) to [out=280, in=135] (1.5,1.5) to [out=315, in=170] (3.5,.5);}
% {\draw[very thick] (.2,3.5) to [out=280, in=135] (1.2,1.2) to [out=315, in=170] (3.5,.2);}
%\draw (3,0)--(0,3);
%
%\fill (1.5,1.5) circle (.05);
%\draw (1.5,1.5) circle (.1);
%
%\end{tikzpicture}

さてこの事実を使って効用最大化問題についてより考えを進めてみよう。
次の点に注意してほしい。予算制約線と無差別曲線が接しているとき, これらの２つの曲線の傾きは一致する。
予算制約の傾き（の絶対値）は $\frac{p_x}{p_y}$ である。
また無差別曲線の傾き（の絶対値）は$\textit{MRS}_{xy}=\frac{MU_x}{MU_y}$である。

したがって効用最大化点ではこの二つが一致する。つまり効用最大化条件は以下の通りである。
%\begin{screen}
```{math}
\underbrace{\textit{MRS}_{xy}=\frac{MU_x}{MU_y}=\frac{\frac{\partial u(q_x,q_y)}{\partial q_x}}{\frac{\partial u(q_x,q_y)}{\partial q_y}}}_{\text{限界代替率}}=\underbrace{\frac{p_x}{p_y}}_{\text{価格比}}
```
%\end{screen}


 効用最大化条件, 「限界代替率$=$価格比」は次のように解釈できる。
効用最大化条件を次のように変形する。
```{math}
\frac{MU_x}{MU_y}=\frac{p_x}{p_y}
\iff \frac{MU_x}{p_x}= \frac{MU_y}{p_y}
```
$1/p_{x}$は１円で購入できる財$x$の量で$1/p_{y}$は１円で購入できる財$y$の量である。
つまり$ \frac{MU_x}{p_x}$は最後の1円を財$x$に使ったときの追加的効用であり、$ \frac{MU_y}{p_y}$は最後の1円を財$y$に使ったときの追加的効用である。
 （通常の）効用最大化問題では予算を使い尽くすことに注意してほしい。
 $\frac{MU_x}{p_x}>\frac{MU_y}{p_y}$なら$y$の消費を少なくし, $x$の消費を増やせば効用が増えるので効用最大化してないのである。
 もし逆の不等式が成立するならば逆のことを行えばやはり効用最大化してないことがわかる。結果、効用最大化しているならば$\frac{MU_x}{p_x}= \frac{MU_y}{p_y}$が成立していなければならないのである。



ただし、限界代替率=価格比が効用最大化を意味しないケースも有る。ひとつは**端点**になるケース，つまりひとつの種類だけの財ばかり消費した方が良い場合がある。例えば同じ種類のコメ1俵の袋が1万円、コメ1斗缶が2000円で売っていたならば量的には1俵$=$4斗であるので，あなたが量しか気にしないのであれば，量あたりの値段が安い一斗缶の方ばかりを買うべきなのである。

もうひとつのケースでは飽和点がある場合である。この場合、予算を余していたとしても飽和点で購入する方が良いので先ほどの議論は当てはまらない。


### 需要関数
 各価格と所得の組について, 効用を最大化する消費プランを割り当てる関数のことを**需要関数**と呼ぶ。 需要は各財についてあるので, 財$x$の需要を$ d _x(p _x,p _y,I)$と書き, 財$ y$の需要を$ d _y(p _x,p _y,I)$と書く。
簡単に需要関数を求めてみよう。効用関数が$u(q_x,q_y)=(q_x)^{1/3}(q_y)^{2/3}$であったとする。
限界代替率は$MRS_{xy}=\dfrac{1}{2}\dfrac{q_y}{q_x}$と計算できるのであった。
効用最大がなされるとき、限界代替率と価格比が一致しなければならないので
```{math}
\dfrac{1}{2}\dfrac{q_y}{q_x}=\frac{p_x}{p_y}
```
となる。この式を変形すると
```{math}
p_yq_y=2p_xq_x
```
が得られる。効用最大化問題の解は制約条件、つまり予算制約を満たさなければならない。予算制約は$p_xq_x+p_yq_y=I$であったのでこの式に先程の条件$p_yq_y=2p_xq_x$を代入すると
```{math}
p_xq_x+2p_xq_x=I\\
\Rightarrow q_x=\frac{I}{3p_x}
```
となる。これが財$x$の需要関数$d _x(p _x,p _y,I)$である。
つまり$d _x(p _x,p _y,I)=\dfrac{I}{3p_x}$となる。
同様にして財$y$の需要関数は
```{math}
d _y(p _x,p _y,I)=\frac{2I}{3p_y}
```
である。




 
 
 
 ## 所得効果と代替効果
 需要の分析で役に立つのは所得や価格が変化したら個々の財の需要がどのように変化するかを調べることができることである。
 
 ### 所得による影響

 まず所得が変化すると需要がどう変化するかを考えよう。これを図で見てみる。{numref}`normalgoods`では所得の上昇（予算線が右上に行く）につれて財$x$も財$y$も消費量が増加している。
このように所得が増えると需要が増える財を**正常財**（または上級財）と呼ぶ。 

```{figure} ch3_img/normalgoods.svg
:name: normalgoods

正常財
```

```{figure} ch3_img/inferiorgoods.svg
:name: inferiorgoods

下級財
```




一方で、{numref}`inferiorgoods`では所得の増加に伴って、財$x$の消費量は増加しているが、財$y$の消費量は減少している。
このように所得が増えると需要が減る財を**下級財**（または劣等財）と呼ぶ[^note3]。

[^note3]:下級財は「常に下級財」ではない，例えば所得0なら消費量はどの財もゼロだが，そこから所得が増えればどんな財であろうと消費量は減りようがない．正常財も常に正常財とも限らない。ただし，常に正常財となることはありうる．

 価格比を一定に保って所得の変化によって変化する消費プランをつないだ曲線を**所得消費曲線**と呼ぶ。
 また個々の財が所得の増加にしたがってどのように変化するかをプロットした曲線を**エンゲル曲線**と呼ぶ。


需要の所得による変動がどれほどのものかを示す基準として、**需要の所得弾力性**と呼ばれるものがある。所得が$I_{\text{前}}$から$I_{\text{後}}$に変化したとき、財$ x$の需要の所得弾力性は次のように定義される。
 ```{math}
  \frac{ \frac{ d _x(p _x,p _y,I_{\text{後}})-d _x(p _x,p _y,I_{\text{前}})} {d _x(p _x,p _y,I_{\text{前}})}}{\frac{I_{\text{後}}-I_{\text{前}}}{I_{\text{前}}}}
 ```  
 あるいは式変形しただけであるが、
 ```{math}
    \frac{  d _x(p _x,p _y,I_{\text{後}})-d _x(p _x,p _y,I_{\text{前}})}{I_{\text{後}}-I_{\text{前}}} \frac{{I_{\text{前}}}}{d _x(p _x,p _y,I_{\text{前}})}
 ``` 
 
 これは需要の変化率$\dfrac{ d _x(p _x,p _y,I_{\text{後}})-d _x(p _x,p _y,I_{\text{前}})} {d _x(p _x,p _y,I_{\text{前}})}$を所得の変化率$\dfrac{I_{\text{後}}-I_{\text{前}}}{I_{\text{前}}}$で割ったものである。
所得の変動$I_{\text{後}}-I_{\text{前}}$が限りなく小さいときには所得弾力性は微分の定義を用いて次のように書くこともできる。
```{math}
\frac{\partial d _x(p _x,p _y,I_{\text{前}})}{\partial I} \frac{I_{\text{前}}}{ d _x(p _x,p _y,I_{\text{前}})}
``` 
 
 正常財ではこの値はプラスとなり、下級財ではマイナスとなる
 正常財をさらに分類する場合がある。
 所得弾力性が$ 0$から$ 1$の間の財を**必需財**と呼ぶ。
  このような財は所得の増加によって財の消費量は増えるが、その増える割合は所得の伸びを下回る。つまり支出に占めるその財の割合が減って行くような財のことなのである。電気・水道や住宅費など生活に必要な費用は所得が増加したとしてもあまり増えたりはしないだろうし、所得が減ったとしても大きく減らすことのできるものでもない。所得が増えた分は他への支出に使うようになることが多いであろう。したがってそういった財を必需財と呼ぶのである。
 
逆に所得弾力性が$ 1$より大きい財は**贅沢財**あるいは奢侈財と呼ぶ。所得の伸び以上に消費の伸びが増えていくのである。
 
 

###  価格による影響

 次に価格の変化による需要の変化を見てみよう。
  一般性を失うことなく財$ x$の価格が上昇したとしてみよう。
すると{numref}`substitute`にあるように予算線の傾きが緩やかになる。財$x$の価格が増加しているので所得をすべて財$x$につかったときに買える財$x$の量が減少しているのである。

さて、{numref}`substitute`では財$x$価格の上昇により、財$ x$の需要は減るが財$ y$の需要は増えている。こういったとき, 財$ y$は財$ x$の**（粗）代替財** であるという。高くなった財$x$の代わりに財$y$の消費量を増やしているのである。財$x$と$y$がお互いに代替的（どちらを消費してもあまり大差がない）であればこういったことが起きやすい。
  
```{figure} ch3_img/substitute.svg
:name: substitute

（粗）代替財
```


```{figure} ch3_img/complementary.svg
:name: complementary

（粗）補完財
```

一方で{numref}`complementary`では財$x$の価格増加に従い財$ x$の需要も財$ y$の需要も減っている。こういったとき, 財$ y$は財$ x$の**（粗）補完財** であるという。財$x$と財$y$が補完的、つまり両方の財を一定の比率で購入しなければ満足できないような関係であるとき、こういったことが起きやすい。



```{figure} ch3_img/giffen.svg
:name: giffen

ギッフェン財
```

 
{numref}`substitute`および{numref}`complementary`では財$x$価格の増加に従い財$x$の需要は減少していた。つまり価格と需要は右下がりの関係にあるということである。この関係は**需要法則**とよばれる。ただしこの関係は常に成り立つとは言えない。

 {numref}`giffen`では財$ x$の需要が価格の増加にもかかわらず増えている。このとき 財$ x$は**ギッフェン財** であるという。どうしてこのようなことが起きるのであろうか。これを知るためには価格による影響を二つの要素に分解して考える必要がある。



### 価格変化の効果を分解する（スルツキー分解） 
  ある財の価格が変化するとき、その需要量の変化は次の２つの効果に分解できる。
 1. ある財の価格が、他の財の価格に比べて変化するとき、消費者は相対的に安くなった財の購入量を増やし、相対的に高くなった財の購入量を減らしたいと考える。これを**代替効果**と呼ぶ。
 1. 価格変化は消費者が同じ所得で購入できる財の量を変化させる。ある財の価格が下がればその分実質的に使えるお金の量は増え、その分を他の財の購入に回したりすることができる。
  こうした変化を**所得効果**と呼ぶ。
  

 どんな需要量の変化も代替効果と所得効果に分解できる。これについて{numref}`slutsky`を見てみよう。価格変化前の消費プランがAであり、価格変化後の消費プランがBである。
 
 
まず財$x$価格の上昇より実質的な所得の減少で効用水準が下がっていることに着目する。こうすると需要量の変化は所得減少の効果を拾ってしまう。一方で価格比が変わったので他の財に代替したいという動機も需要変化に現れるはずである。この二つの効果を分離したいと考える。

 そこで変化後の価格比で変化前の効用水準を達成する所得で予算線を描く。これは**補償所得**と呼ばれ、それが与えられたときの予算線は点Cを通る直線である。

この補助線を引くと価格による変化を二つの効果に分解できる。AからCへの変化を**代替効果**と呼ぶ。つまり効用水準を保つように所得が補償されるならば所得のことを考えないで価格だけを考えて購入量を決めているようなものである。これにより価格比の変化による効果だけを拾うことができるのである。
一方で、CからBへの変化を**所得効果**と呼ぶ。Cを通る予算線とBを通る予算線では価格比は同じで所得水準だけが異なる。これにより所得による影響を書き表すことができるのである。

 この分解方法を**スルツキー分解**という。ギッフェン財は下級財で、所得減少による需要の増加が代替効果による減少を上回ることで発生する[^note4].
 
 
 [^note4]:現実にギッフェン財は存在するかと言われると、非常に珍しいが存在する。これについて日本の焼酎はギッフェン財だという研究がある。（Shmuel Baruch and Yakar Kannai, 2001, ``Inferior Goods, Giffen Goods, and Shochu'',  Economic Essays, pp. 9--17）また、動物実験を用いてラットにとってキニーネ入りの飼料（キニーネはトニックウォーターの原料、非常に苦い）がギッフェン財であることを示した研究もある。Thomas Hastjarjo, Alan Silberberg, and Steven R Hursh, 1990, ``Quinine pellets as an inferior good and a Giffen good in rats,'' Journal of the Experimental Analysis of Behavior. 
 
```{figure} ch3_img/slutsky.svg
:name: slutsky

スルツキー分解
```
 
 




